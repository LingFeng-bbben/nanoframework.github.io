<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>MFRC522 - RFID reader | .NET nanoFramework Documentation </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="MFRC522 - RFID reader | .NET nanoFramework Documentation ">
    

      <link rel="apple-touch-icon" sizes="180x180" href="../../favicons/apple-touch-icon.png">
      <link rel="icon" type="image/png" sizes="32x32" href="../../favicons/favicon-32x32.png">
      <link rel="icon" type="image/png" sizes="16x16" href="../../favicons/favicon-16x16.png">
      <link rel="manifest" href="../../favicons/site.webmanifest">
      <link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico">
      <link rel="mask-icon" href="../../favicons/safari-pinned-tab.svg" color="#179b88">
      <meta name="msapplication-config" content="../../favicons/browserconfig.xml">
      <meta name="msapplication-TileColor" content="#222222">
      <meta name="theme-color" content="#222222">

      <link rel="stylesheet" href="../../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../../styles/docfx.css">
      <link rel="stylesheet" href="../../styles/main.css">
      <meta property="docfx:navrel" content="../../toc.html">
      <meta property="docfx:tocrel" content="../../x-cross/toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="mfrc522---rfid-reader">MFRC522 - RFID reader</h1>

<p>MFRC522 is a very cheap RFID/NFC reader for Iso 14443 Type A cards. Part of those cars are the <a href="../Card/Mifare">Mifare</a> and <a href="../Card/Ultralight">Ultralight</a> family. This reader implement the proprietary Mifare cryptography protocol and can be used transparently.</p>
<h2 id="documentation">Documentation</h2>
<ul>
<li>MFRC5222 <a href="https://www.nxp.com/docs/en/data-sheet/MFRC522.pdf">Datasheet</a></li>
</ul>
<h2 id="usage">Usage</h2>
<p>MFRC522 supports SPI, I2C and UART (Serial Port). You can create the reader with any of those protocols.</p>
<p><strong>Note</strong>: most of the popular boards you'll buy are SPI only. This documentation will focus on SPI. You have in the <a href="./samples">samples</a> more information on how to setup I2C and UART.</p>
<pre><code class="lang-csharp">GpioController gpioController = new GpioController();
// adjust the GPIO used for the hard reset
int pinReset = 21;

// Default on ESP32:
// GPIO23 = MOSI; GPIO25 = MISO; GPIO19 = Clock

// Uncomment for SPI
SpiConnectionSettings connection = new(1, 22);
// Here you can use as well MfRc522.MaximumSpiClockFrequency which is 10_000_000
// Anything lower will work as well
connection.ClockFrequency = 5_000_000;
SpiDevice spi = SpiDevice.Create(connection);
MfRc522 mfrc522 = new(spi, pinReset, gpioController, false);
</code></pre>
<p>The code will create an instance of MFRC522 and will use the pin GPIO21 as the hardware rest pin and will create an GpioController automatically from the default driver. Check the detailed [samples] for more elements. More detailed examples shows how to use other type or cards.</p>
<p>You can get the version using the <code>Version</code> property.</p>
<pre><code class="lang-csharp">Debug.WriteLine($&quot;Version: {mfrc522.Version}, version should be 1 or 2. Some clones may appear with version 0&quot;);
</code></pre>
<p>Keep in mind that having a version which is 0.0 doesn't necessary means that your reader is not working properly, if you bought a cheap copy of an original MFRC522, the internal version may not be recognized.</p>
<p>MFRC522 only supports ISO 14443 Type A. You can pull a card like this:</p>
<pre><code class="lang-csharp">bool res;
Data106kbpsTypeA card;
do
{
    res = mfrc522.ListenToCardIso14443TypeA(out card, TimeSpan.FromSeconds(2));
    Thread.Sleep(res ? 0 : 200);
}
while (!res);
</code></pre>
<p>As soon as a card will be detected, it will get out a <code>Data106kbpsTypeA</code> class which is a card. You will have the Unique Identifier from the card as well as the rest of the elements to help identifying it.</p>
<p>You can then create a Mifare card and fo operation on it:</p>
<pre><code class="lang-csharp">var mifare = new MifareCard(mfrc522, 0);
mifare.SerialNumber = card.NfcId;
mifare.Capacity = MifareCardCapacity.Mifare1K;
mifare.KeyA = MifareCard.DefaultKeyA;
mifare.KeyB = MifareCard.DefaultKeyB;

mifare.BlockNumber = 0;
mifare.Command = MifareCardCommand.AuthenticationB;
ret = mifare.RunMifareCardCommand();
if (ret &lt; 0)
{
    mifare.ReselectCard();
    Debug.WriteLine($&quot;Error reading bloc: {mifare.BlockNumber}&quot;);
}
else
{
    mifare.Command = MifareCardCommand.Read16Bytes;
    ret = mifare.RunMifareCardCommand();
    if (ret &gt;= 0)
    {
        if (mifare.Data is object)
        {
            Debug.WriteLine($&quot;Bloc: {mifare.BlockNumber}, Data: {BitConverter.ToString(mifare.Data)}&quot;);
        }
    }
    else
    {
        mifare.ReselectCard();
        Debug.WriteLine($&quot;Error reading bloc: {mifare.BlockNumber}&quot;);
    }
}
</code></pre>
<p><strong>Important</strong>: you have to do the <code>ReselectCard()</code> operation every time you have a failure in reading or authentication. By default the card will stop responding. This behavior is wanted by design to make is longer to brute force the authentication mechanism. The <a href="./samples">samples</a> shows a way how to find a key from known keys for <a href="../Card/Ndef">NDEF</a> scenarios for example. Note that the sample is not fully optimize, it is to help understanding what as the mechanism behind.</p>
<h2 id="other-notes">Other notes</h2>
<ul>
<li>The SPI implementation has been deeply tested.</li>
<li>The I2C and UART has been barely tested due to lack of hardware support. So please open issues if you have any issue.</li>
<li>When using I2C, the address can be setup using the hardware pin, it's the reason why there is no default address.</li>
<li>If you are using UART, it is more than strongly recommended to use as high as possible serial baud transfer.</li>
</ul>
</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/nanoframework/nanoframework.IoT.Device/blob/develop/devices/Mfrc522/README.md/#L1" class="contribution-link">Edit this page</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In this article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Copyright © 2023 nanoFramework Contributors<br>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>    </div>

    <script type="text/javascript" src="../../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>

